<div class="journey-container">
    <svg class="road-svg" viewBox="0 0 100 400" preserveAspectRatio="none">
        <defs>
            <linearGradient id="carGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#e74c3c;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#c0392b;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="bodyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#f39c12;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e67e22;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="suitGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#34495e;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#2c3e50;stop-opacity:1" />
            </linearGradient>
            <radialGradient id="headGradient" cx="40%" cy="30%" r="60%">
                <stop offset="0%" style="stop-color:#f9a825;stop-opacity:1" />
                <stop offset="70%" style="stop-color:#f39c12;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e67e22;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="carBody3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#e74c3c;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#c0392b;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#8B0000;stop-opacity:1" />
            </radialGradient>
            <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur in="SourceAlpha" stdDeviation="2" />
                <feOffset dx="1" dy="2" result="offsetblur" />
                <feComponentTransfer>
                    <feFuncA type="linear" slope="0.3" />
                </feComponentTransfer>
                <feMerge>
                    <feMergeNode />
                    <feMergeNode in="SourceGraphic" />
                </feMerge>
            </filter>
        </defs>

        <!-- The Road Path (Visual) -->
        <!-- Layer 1: Sidewalks - Light gray matching site bg -->
        <path d="M20,0 
         C20,60 10,100 10,150 
         C10,200 90,200 90,250 
         C90,300 20,340 20,400" fill="none" stroke="#e8e8e8" stroke-width="18" stroke-linecap="round" opacity="0.8" />

        <!-- Layer 2: Curbs - Subtle definition -->
        <path d="M20,0 
         C20,60 10,100 10,150 
         C10,200 90,200 90,250 
         C90,300 20,340 20,400" fill="none" stroke="#d0d0d0" stroke-width="14" stroke-linecap="round" />

        <!-- Layer 3: Main Road (Black matching nav/buttons) -->
        <path #roadPath d="M20,0 
         C20,60 10,100 10,150 
         C10,200 90,200 90,250 
         C90,300 20,340 20,400" fill="none" stroke="#000000" stroke-width="10" stroke-linecap="round"
            class="road-base" />
        <!-- Road Markings (Brand red) -->
        <path d="M20,0 
         C20,60 10,100 10,150 
         C10,200 90,200 90,250 
         C90,300 20,340 20,400" fill="none" stroke="#c41e3a" stroke-width="1.2" stroke-dasharray="8 4"
            class="road-markings" />

        <!-- Waiting Car (Static on Road) -->
        <!-- Moved to 90, 250 to match new curve peak -->
        <g *ngIf="showWaitingCar" class="waiting-car">
            <g transform="translate(90, 250) rotate(90) scale(0.15)">
                <!-- Car Shape -->
                <rect x="-15" y="-10" width="30" height="20" rx="4" fill="url(#carGradient)" filter="url(#shadow)" />
                <rect x="-10" y="-8" width="20" height="16" rx="2" fill="#333" /> <!-- Window -->
                <rect x="-12" y="-6" width="24" height="12" rx="1" fill="#c0392b" /> <!-- Roof info -->
            </g>
        </g>

    </svg>

    <!-- Home Location Pin (at the end) -->
    <div class="house-container" style="left: 20%; top: 100%;">
        <div class="pin-marker">
            <img src="home.png" alt="Home" class="home-image-icon" />
        </div>
    </div>

    <!-- The Character (Moves on top) -->
    <div class="character-container" [style.left.%]="characterPosition.x" [style.top.%]="characterPosition.y / 4"
        [style.transform]="'translate(-50%, -50%)'">

        <!-- SHARED TOOLTIP (STABLE POSITION) -->
        <div class="scroll-tooltip" *ngIf="showTooltip">
            {{ hasCar ? 'Honk honk! üèéÔ∏èüí®' : (hasSuit ? 'Move me down ‚Üì' : 'Guide my journey ‚Üì') }}
        </div>

        <!-- CAR IMAGE -->
        <div *ngIf="hasCar" class="car-image-wrapper"
            [style.transform]="'rotate(' + (characterPosition.angle + 90) + 'deg)'" (click)="toggleTooltip($event)">
            <img src="car.png" alt="Car" class="car-img" />
        </div>

        <!-- STUDENT IMAGE -->
        <div *ngIf="!hasCar && !hasSuit" class="character-image-wrapper" (click)="toggleTooltip($event)">
            <img src="student.png" alt="Student" class="character-img" />
        </div>

        <!-- EMPLOYEE IMAGE -->
        <div *ngIf="!hasCar && hasSuit" class="character-image-wrapper" (click)="toggleTooltip($event)">
            <img src="employee.png" alt="Employee" class="character-img" />
        </div>
    </div>
</div>